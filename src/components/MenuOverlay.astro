---
import "../styles/MenuOverlay.css";
---

<div class="menu-overlay" id="menuOverlay" style="display: none;">
  <div class="close-button" id="closeButton">×</div>
  <div class="dropdown-link-container">
    <div>
      <h1 class="dropdown-parent" id="homeLink">Home</h1>
    </div>
    <div>
      <h1 class="dropdown-parent">About Us</h1>
      <div class="dropdown-child">
        Educational model
        <br />
        Facilities
        <br />
        Legal
        <br />
        People operations
      </div>
    </div>
    <div>
      <h1 class="dropdown-parent">Academics</h1>
      <div class="dropdown-child">
        Extracurriculars
        <br />
        Student services
        <br />
        Scholarships
        <br />
        Internships
      </div>
    </div>
    <div>
      <h1 class="dropdown-parent">Mobility</h1>
      <div class="dropdown-child"></div>
    </div>
    <div>
      <h1 class="dropdown-parent">Services</h1>
      <div class="dropdown-child"></div>
    </div>
    <div>
      <h1 class="dropdown-parent">Communication</h1>
      <div class="dropdown-child"></div>
    </div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const closeButton = document.getElementById("closeButton") as HTMLElement;
      const menuOverlay = document.getElementById("menuOverlay") as HTMLElement;
      const dropdownParents = document.querySelectorAll(
        ".dropdown-parent"
      ) as NodeListOf<HTMLElement>;
      const homeLink = document.getElementById("homeLink") as HTMLElement; // Referencia a Home

      if (closeButton && menuOverlay) {
        closeButton.addEventListener("click", () => {
          menuOverlay.style.display = "none";
        });
      }

      // Lógica especial para "Home"
      homeLink.addEventListener("click", () => {
        menuOverlay.style.display = "none"; // Cerrar el menú
        window.scrollTo(0, 0); // Redirigir a la parte superior
      });

      dropdownParents.forEach((parent) => {
        parent.addEventListener("click", (event) => {
          // Prevenir que el clic en "Home" se propague
          if (event.target === homeLink) return;

          const child = parent.nextElementSibling as HTMLElement;

          // Mostrar u ocultar el dropdown actual
          const isVisible = window.getComputedStyle(child).display === "block";

          if (!isVisible) {
            // Ocultar todos los otros dropdown-child y mostrar solo el actual
            dropdownParents.forEach((otherParent) => {
              const otherChild = otherParent.nextElementSibling as HTMLElement;
              if (otherParent !== parent) {
                otherParent.style.display = "none"; // Ocultar otros parents
                if (
                  otherChild &&
                  otherChild.classList.contains("dropdown-child")
                ) {
                  otherChild.style.display = "none"; // Ocultar otros dropdowns
                }
              }
            });
            // Mostrar el dropdown actual
            child.style.display = "block"; // Mostrar el child actual
            parent.style.display = "block"; // Asegurarse de que el parent sea visible
          } else {
            // Volver a mostrar todos los elementos del menú
            dropdownParents.forEach((otherParent) => {
              otherParent.style.display = "block"; // Mostrar todos los parents
              const otherChild = otherParent.nextElementSibling as HTMLElement;
              if (
                otherChild &&
                otherChild.classList.contains("dropdown-child")
              ) {
                otherChild.style.display = "none"; // Ocultar todos los dropdowns
              }
            });
          }
        });
      });
    });
  </script>
</div>
